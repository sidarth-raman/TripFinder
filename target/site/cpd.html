<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2021-04-09 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>TripFinder - CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20210409" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                TripFinder
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2021-04-09</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0</span>
                      </div>
            <div class="xright">                    <a href="${project.url}" title="TripFinder">TripFinder</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                          <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                              <li class="expanded">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                    <ul>
                      <li class="none">
                          <a href="xref/index.html" title="Source Xref">Source Xref</a>
            </li>
                      <li class="none">
                          <a href="xref-test/index.html" title="Test Source Xref">Test Source Xref</a>
            </li>
                      <li class="none">
                          <a href="apidocs/index.html" title="Javadoc">Javadoc</a>
            </li>
                      <li class="none">
                          <a href="checkstyle.html" title="Checkstyle">Checkstyle</a>
            </li>
                      <li class="none">
            <strong>CPD</strong>
          </li>
                      <li class="none">
                          <a href="pmd.html" title="PMD">PMD</a>
            </li>
                      <li class="none">
                          <a href="spotbugs.html" title="SpotBugs">SpotBugs</a>
            </li>
                      <li class="none">
                          <a href="surefire-report.html" title="Surefire Report">Surefire Report</a>
            </li>
                      <li class="none">
                          <a href="jacoco/index.html" title="JaCoCo">JaCoCo</a>
            </li>
              </ul>
        </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2>CPD Results<a name="CPD_Results"></a></h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.13.0.</p></div>
<div class="section">
<h2>Duplications<a name="Duplications"></a></h2>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu/brown/cs/mramesh4/TripGraph/CompleteTripGraph.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/TripGraph/CompleteTripGraph.html#L78">78</a></td></tr>
<tr class="a">
<td>edu/brown/cs/mramesh4/TripGraph/TripGraph.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/TripGraph/TripGraph.html#L45">45</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }
  }

  /**
   * This is a method to run aStar on a graph.
   * @param start the name of the start city
   * @param end the name of the end city.
   * @return a list of nodes to visit
   */
  public List&lt;N&gt; aStar(String start, String end){
    List&lt;N&gt; ret = new ArrayList&lt;&gt;();
    if(!graph.containsKey(start) || !graph.containsKey(end)){
      return null;
    } else if(start.equals(end)){
      ret.add(graph.get(start));
      return ret;
    } else{
      ret = aStarHelper(graph.get(start), graph.get(end));
      return ret;
    }
  }

  /**
   * This is a helper to run aStar within the graph that we are writing
   * @param start the start node to search from
   * @param end the end node to start from
   * @return a list of nodes
   */
  public List&lt;N&gt; aStarHelper(N start, N end){
    ArrayList&lt;N&gt; ret = new ArrayList&lt;&gt;();
    //create a comparator that sorts them by a weight aStar assigns them
    PriorityQueue&lt;N&gt; pq = new PriorityQueue&lt;N&gt;(new TripGraphNodeComparator&lt;N, E&gt;());
    //set the distance travelled to 0
    start.setDistance(0);
    start.setWeight(0);
    //keep track of a visited
    HashMap&lt;String, N&gt; visited = new HashMap&lt;&gt;();
    HashMap&lt;N, List&lt;E&gt;&gt; deletedEdges = new HashMap&lt;&gt;();
    //put them in the visited
    visited.put(start.getName(), start);
    List&lt;N&gt; nodes = new ArrayList&lt;&gt;();
    //nodes.add(start);
    pq.add(start);
    return aStarHelp(end, pq, nodes, visited);
  }

  /**
   * Helper method to conduct the AStar search recursively and use backtracking
   * to save the route, since this method could not be used previously.
   * @param end the end node to search for
   * @param pq priorityqueue to use
   * @param nodes nodes of curr path
   * @param visited map of visited
   * @return a list of Nodes.
   */
  public List&lt;N&gt; aStarHelp(N end, PriorityQueue&lt;N&gt; pq, List&lt;N&gt; nodes, HashMap&lt;String, N&gt; visited){
    if(!pq.isEmpty()){
      N curr = pq.poll();
      nodes.add(curr);
      if (curr.equals(end)) {
        //return a copy in order to prevent alteration
        return new ArrayList&lt;&gt;(nodes);
      }
      List&lt;N&gt; neighbors = curr.getNeighbors();
      for(N next: neighbors){
        if(next.equals(curr)) {
          continue;
        } else{
          String name = next.getName();
          Double dist = curr.getDistance() + curr.getConnectingEdges().get(name).getWeight();
          Double totalWeight = dist + next.toGoal(end);
          if (!visited.containsKey(next.getName())) {
            next.setDistance(dist);
            next.setWeight(totalWeight);
            visited.put(next.getName(), next);
            pq.add(next);
          } else {
            N prev = visited.get(next.getName());
            //checking if we want to update the weight and distance
            if (prev.getWeight() &gt; totalWeight) {
              next.setDistance(dist);
              next.setWeight(totalWeight);
              visited.put(next.getName(), next);
              pq.add(next);
            }
          }
        }
      }
      //backtracking
      List&lt;N&gt; ret = aStarHelp(end, pq, nodes, visited);
      nodes.remove(curr);
      return ret;
    } else{
      if(visited.containsKey(end)){
        return nodes;
      } else{
        return null;
      }
    }
  }

  /**
   * This is used to insert a node into the graph.
   * @param node the node to insert into the graph
   */
  public void insertNode(N node){</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu/brown/cs/mramesh4/stars/StarsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/stars/StarsLogic.html#L483">483</a></td></tr>
<tr class="a">
<td>edu/brown/cs/mramesh4/stars/StarsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/stars/StarsLogic.html#L556">556</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }

    //sort the entries into a list of keys;
    ArrayList&lt;Double&gt; keys = new ArrayList&lt;&gt;(map.keySet());
    //sort the keys in order from descending to ascending
    Collections.sort(keys);
    //a counter to go through the list
    int start = 0;
    //while we still have keys to go through and more neighbors:
    while (start &lt; keys.size() &amp;&amp; k &gt; 0) {
      //get the nextClosestStars
      ArrayList&lt;Star&gt; nextClosestStars = map.get(keys.get(start));
      //subtract k
      int size = nextClosestStars.size();
      k -= size;
      //if k is below 0, that means there was
      // overflow by the size - k, so we need to select
      //size - k elements to add
      if (k &lt; 0) {
        for (int i = 0; i &lt; size - Math.abs(k); i++) {
          //generate a randomInt based on the current remaining stars
          int randomInt = (int) (Math.random()
              * (nextClosestStars.size()));
          //add the star
          ret.add(nextClosestStars.get(randomInt));
          //remove it from the list of remaining stars
          nextClosestStars.remove(randomInt);
        }
        //since we have hit k we are done;
        break;
      } else {
        //add the nextStar
        for (Star nextStar: nextClosestStars) {
          ret.add(nextStar);
        }
        //increment start;
        start++;
      }
    }
    //return our arrayList
    return ret;
  }
  /**.
   * Calculates the k nearest neighbors to a star with name
   * @param k Non-negative number of neighbors to find
   * @param name Name of the star
   * @return a List of Stars closest to the Star searched
   * for
   */
  public List&lt;Star&gt; naiveNearestNeighbors(int k, String name) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu/brown/cs/mramesh4/maps/MapsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/maps/MapsLogic.html#L395">395</a></td></tr>
<tr class="a">
<td>edu/brown/cs/mramesh4/maps/MapsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/maps/MapsLogic.html#L499">499</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          this.printRoute(start, end);
        }
      }
      //lat and long inputted
    } else {
      try {
        double lat1 = Double.parseDouble(coms[1]);
        double long1 = Double.parseDouble(coms[2]);
        WayNodes startTarget = this.getWayNodeByLatLong(lat1, long1);
        //find start node using nearestNeighbors
        List&lt;WayNodes&gt; startRet = wayNodesTree.nearestNeighbors(1, startTarget, false);
        start = startRet.get(0);
        double lat2 = Double.parseDouble(coms[3]);
        double long2 = Double.parseDouble(coms[4]);
        WayNodes endTarget = this.getWayNodeByLatLong(lat2, long2);
        //find ending node using nearestNeighbors
        List&lt;WayNodes&gt; endRet = wayNodesTree.nearestNeighbors(1, endTarget, false);
        end = endRet.get(0);
        //if start and end nodes are same, want to print nothing
        if (start.equals(end)) {
          System.out.println(&quot;No route found- start and end nodes are the same&quot;);
          return;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu/brown/cs/mramesh4/maps/GUIHandler.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/maps/GUIHandler.html#L266">266</a></td></tr>
<tr class="a">
<td>edu/brown/cs/mramesh4/maps/GUIHandler.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/maps/GUIHandler.html#L320">320</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            ret += &quot;&lt;br&gt; &lt;br&gt;&quot;;
            ret += &quot;&lt;table id=\&quot;table\&quot;&gt;&quot;
              + &quot;&lt;tr&gt; &lt;th&gt; Match # &lt;/th&gt; &lt;th&gt; Name &lt;/th&gt;&quot;
              + &quot;&lt;th&gt; ID &lt;/th&gt; &lt;th&gt; X &lt;/th&gt; &lt;th&gt; Y &lt;/th&gt; &lt;th&gt; Z &lt;/th&gt; &lt;/tr&gt;&quot;;
            for (int i = 0; i &lt; stars.size(); i++) {
              Star curr = stars.get(i);
              ret += &quot;&lt;tr&gt;&lt;td&gt;&quot; + Integer.toString(i + 1) + &quot;&lt;/td&gt;&quot; + &quot;&lt;td&gt;&quot; + curr.getName()
                + &quot;&lt;/td&gt;&quot; + &quot;&lt;td&gt;&quot; + curr.getStarID() + &quot;&lt;/td&gt;&quot;
                + &quot;&lt;td&gt;&quot; + curr.getX() + &quot;&lt;/td&gt;&quot;
                + &quot;&lt;td&gt;&quot; + curr.getY() + &quot;&lt;/td&gt;&quot;
                + &quot;&lt;td&gt;&quot; + curr.getZ() + &quot;&lt;/td&gt;&quot;;
              ret += &quot;&lt;/tr&gt;&quot;;
            }
            ret += &quot;&lt;/table&gt;&quot;;
          } else {
            ret = &quot;No stars found in the search&quot;;
          }
        }
      }
      Map&lt;String, Object&gt; variables = ImmutableMap.of(&quot;title&quot;,
          &quot;Stars: Query the database&quot;, &quot;results&quot;, ret);
      return new ModelAndView(variables, &quot;query.ftl&quot;);
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu/brown/cs/mramesh4/stars/StarsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/stars/StarsLogic.html#L348">348</a></td></tr>
<tr class="a">
<td>edu/brown/cs/mramesh4/stars/StarsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/stars/StarsLogic.html#L415">415</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        }
        List&lt;Star&gt; ret = new ArrayList&lt;&gt;();
        if (coms.length == 3) {
          //call nearest_radius with radius/name
          if (!naive) {
            ret = nearestRadius(r, coms[2]);
          } else {
            ret = naiveNearestRadius(r, coms[2]);
          }
        } else {
          double x = Double.parseDouble(coms[2]);
          double y = Double.parseDouble(coms[3]);
          double z = Double.parseDouble(coms[4]);
          if (!naive) {
            ret = nearestRadius(r, x, y, z);
          } else {
            ret = naiveNearestRadius(r, x, y, z);
          }
        }
        if (ret == null) {
          System.err.println(&quot;ERROR: Invalid Search&quot;);
          return null;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu/brown/cs/mramesh4/stars/StarsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/stars/StarsLogic.html#L200">200</a></td></tr>
<tr class="a">
<td>edu/brown/cs/mramesh4/stars/StarsLogic.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/stars/StarsLogic.html#L271">271</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        }
        //call different helpers based on args supplied
        if (coms.length == 3) {
          if (!naive) {
            ret = nearestNeighbors(knn, coms[2]);
          } else {
            ret = naiveNearestNeighbors(knn, coms[2]);
          }
          //print every star in the returned list
        } else {
          double x = Double.parseDouble(coms[2]);
          double y = Double.parseDouble(coms[3]);
          double z = Double.parseDouble(coms[4]);
          if (!naive) {
            ret = nearestNeighbors(knn, x, y, z);
          } else {
            ret = naiveNearestNeighbors(knn, x, y, z);
          }
        }
        if (ret == null) {
          System.err.println(&quot;ERROR: INVALID SEARCH&quot;);
          return null;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu/brown/cs/mramesh4/TripGraph/CityNode.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/TripGraph/CityNode.html#L210">210</a></td></tr>
<tr class="a">
<td>edu/brown/cs/mramesh4/maps/WayNodes.java</td>
<td><a href="./xref/edu/brown/cs/mramesh4/maps/WayNodes.html#L246">246</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    double thisLon = Math.toRadians(longit);
    double goalLat = Math.toRadians(goal.getLat());
    double goalLon = Math.toRadians(goal.getLong());
    /**
     * Haversine formula: I got this from
     * https://www.geeksforgeeks.org/program-distance-two-points-earth/
     */
    double dlon = goalLon - thisLon;
    double dlat = goalLat - thisLat;
    double havernmath = Math.pow(Math.sin(dlat / 2), 2)
        + Math.cos(thisLat) * Math.cos(goalLat)
        * Math.pow(Math.sin(dlon / 2), 2);
    double finalanswer = 2 * Math.asin(Math.sqrt(havernmath));
    // Radius of earth in kilometers. Use 3956 for miles
    return (finalanswer * EARTH_RADIUS_IN_KM);
  }


}</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2021.
          All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
